// 
// Copyright (c) Microsoft and contributors.  All rights reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//   http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// 
// See the License for the specific language governing permissions and
// limitations under the License.
// 

// Warning: This code was generated by a tool.
// 
// Changes to this file may cause incorrect behavior and will be lost if the
// code is regenerated.

using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using Hyak.Common;
using Microsoft.Azure.Management.DataLake.AnalyticsCatalog;
using Microsoft.Azure.Management.DataLake.AnalyticsCatalog.Models;
using Newtonsoft.Json.Linq;

namespace Microsoft.Azure.Management.DataLake.AnalyticsCatalog
{
    /// <summary>
    /// Operations for managing the Data Lake Analytics catalog
    /// </summary>
    internal partial class CatalogOperations : IServiceOperations<DataLakeAnalyticsCatalogManagementClient>, ICatalogOperations
    {
        /// <summary>
        /// Initializes a new instance of the CatalogOperations class.
        /// </summary>
        /// <param name='client'>
        /// Reference to the service client.
        /// </param>
        internal CatalogOperations(DataLakeAnalyticsCatalogManagementClient client)
        {
            this._client = client;
        }
        
        private DataLakeAnalyticsCatalogManagementClient _client;
        
        /// <summary>
        /// Gets a reference to the
        /// Microsoft.Azure.Management.DataLake.AnalyticsCatalog.DataLakeAnalyticsCatalogManagementClient.
        /// </summary>
        public DataLakeAnalyticsCatalogManagementClient Client
        {
            get { return this._client; }
        }
        
        /// <summary>
        /// Creates the specified secret for use with external data sources in
        /// the specified database
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to create the secret in.
        /// </param>
        /// <param name='parameters'>
        /// Required. The parameters required to create the secret (name and
        /// password)
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The create secret operation response.
        /// </returns>
        public async Task<CatalogSecretCreateResponse> CreateSecretAsync(string resourceGroupName, string accountName, string databaseName, DataLakeAnalyticsCatalogSecretCreateOrUpdateParameters parameters, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (parameters == null)
            {
                throw new ArgumentNullException("parameters");
            }
            if (parameters.Password == null)
            {
                throw new ArgumentNullException("parameters.Password");
            }
            if (parameters.SecretName == null)
            {
                throw new ArgumentNullException("parameters.SecretName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("parameters", parameters);
                TracingAdapter.Enter(invocationId, this, "CreateSecretAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/secrets/";
            url = url + Uri.EscapeDataString(parameters.SecretName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Put;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Serialize Request
                string requestContent = null;
                JToken requestDoc = null;
                
                JObject dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue = new JObject();
                requestDoc = dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue;
                
                dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue["password"] = parameters.Password;
                
                if (parameters.Uri != null)
                {
                    dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue["uri"] = parameters.Uri;
                }
                
                requestContent = requestDoc.ToString(Newtonsoft.Json.Formatting.Indented);
                httpRequest.Content = new StringContent(requestContent, Encoding.UTF8);
                httpRequest.Content.Headers.ContentType = MediaTypeHeaderValue.Parse("application/json");
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, requestContent, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogSecretCreateResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogSecretCreateResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlSecret secretInstance = new USqlSecret();
                            result.Secret = secretInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                secretInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken credentialNameValue = responseDoc["credentialName"];
                            if (credentialNameValue != null && credentialNameValue.Type != JTokenType.Null)
                            {
                                string credentialNameInstance = ((string)credentialNameValue);
                                secretInstance.Name = credentialNameInstance;
                            }
                            
                            JToken userNameValue = responseDoc["userName"];
                            if (userNameValue != null && userNameValue.Type != JTokenType.Null)
                            {
                                string userNameInstance = ((string)userNameValue);
                                secretInstance.UserName = userNameInstance;
                            }
                            
                            JToken identityValue = responseDoc["identity"];
                            if (identityValue != null && identityValue.Type != JTokenType.Null)
                            {
                                Guid identityInstance = Guid.Parse(((string)identityValue));
                                secretInstance.Identity = identityInstance;
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                secretInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                secretInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Deletes the specified secret in the specified database
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to delete the secret from.
        /// </param>
        /// <param name='secretName'>
        /// Optional. The name of the secret to delete
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The create secret operation response.
        /// </returns>
        public async Task<CatalogSecretCreateResponse> DeleteSecretAsync(string resourceGroupName, string accountName, string databaseName, string secretName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("secretName", secretName);
                TracingAdapter.Enter(invocationId, this, "DeleteSecretAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/secrets";
            if (secretName != null)
            {
                url = url + "/" + Uri.EscapeDataString(secretName);
            }
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Delete;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogSecretCreateResponse result = null;
                    // Deserialize Response
                    result = new CatalogSecretCreateResponse();
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified assembly from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the assembly in.
        /// </param>
        /// <param name='assemblyName'>
        /// Required. The name of the assembly to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get Database operation response.
        /// </returns>
        public async Task<CatalogAssemblyGetResponse> GetAssemblyAsync(string resourceGroupName, string accountName, string databaseName, string assemblyName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (assemblyName == null)
            {
                throw new ArgumentNullException("assemblyName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("assemblyName", assemblyName);
                TracingAdapter.Enter(invocationId, this, "GetAssemblyAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/assemblies/";
            url = url + Uri.EscapeDataString(assemblyName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogAssemblyGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogAssemblyGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlAssembly assemblyInstance = new USqlAssembly();
                            result.Assembly = assemblyInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                assemblyInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken assemblyNameValue = responseDoc["assemblyName"];
                            if (assemblyNameValue != null && assemblyNameValue.Type != JTokenType.Null)
                            {
                                string assemblyNameInstance = ((string)assemblyNameValue);
                                assemblyInstance.Name = assemblyNameInstance;
                            }
                            
                            JToken clrNameValue = responseDoc["clrName"];
                            if (clrNameValue != null && clrNameValue.Type != JTokenType.Null)
                            {
                                string clrNameInstance = ((string)clrNameValue);
                                assemblyInstance.ClrName = clrNameInstance;
                            }
                            
                            JToken isVisibleValue = responseDoc["isVisible"];
                            if (isVisibleValue != null && isVisibleValue.Type != JTokenType.Null)
                            {
                                bool isVisibleInstance = ((bool)isVisibleValue);
                                assemblyInstance.IsVisible = isVisibleInstance;
                            }
                            
                            JToken isUserDefinedValue = responseDoc["isUserDefined"];
                            if (isUserDefinedValue != null && isUserDefinedValue.Type != JTokenType.Null)
                            {
                                bool isUserDefinedInstance = ((bool)isUserDefinedValue);
                                assemblyInstance.IsUserDefined = isUserDefinedInstance;
                            }
                            
                            JToken filesArray = responseDoc["files"];
                            if (filesArray != null && filesArray.Type != JTokenType.Null)
                            {
                                foreach (JToken filesValue in ((JArray)filesArray))
                                {
                                    USqlAssemblyFileInfo uSqlAssemblyFileInfoInstance = new USqlAssemblyFileInfo();
                                    assemblyInstance.Files.Add(uSqlAssemblyFileInfoInstance);
                                    
                                    JToken typeValue = filesValue["type"];
                                    if (typeValue != null && typeValue.Type != JTokenType.Null)
                                    {
                                        FileType typeInstance = DataLakeAnalyticsCatalogManagementClient.ParseFileType(((string)typeValue));
                                        uSqlAssemblyFileInfoInstance.Type = typeInstance;
                                    }
                                    
                                    JToken originalPathValue = filesValue["originalPath"];
                                    if (originalPathValue != null && originalPathValue.Type != JTokenType.Null)
                                    {
                                        string originalPathInstance = ((string)originalPathValue);
                                        uSqlAssemblyFileInfoInstance.OriginalPath = originalPathInstance;
                                    }
                                    
                                    JToken contentPathValue = filesValue["contentPath"];
                                    if (contentPathValue != null && contentPathValue.Type != JTokenType.Null)
                                    {
                                        string contentPathInstance = ((string)contentPathValue);
                                        uSqlAssemblyFileInfoInstance.ContentPath = contentPathInstance;
                                    }
                                }
                            }
                            
                            JToken dependenciesArray = responseDoc["dependencies"];
                            if (dependenciesArray != null && dependenciesArray.Type != JTokenType.Null)
                            {
                                foreach (JToken dependenciesValue in ((JArray)dependenciesArray))
                                {
                                    USqlAssemblyDependencyInfo uSqlAssemblyDependencyInfoInstance = new USqlAssemblyDependencyInfo();
                                    assemblyInstance.Dependencies.Add(uSqlAssemblyDependencyInfoInstance);
                                    
                                    JToken entityIdValue = dependenciesValue["entityId"];
                                    if (entityIdValue != null && entityIdValue.Type != JTokenType.Null)
                                    {
                                        EntityId entityIdInstance = new EntityId();
                                        uSqlAssemblyDependencyInfoInstance.EntityId = entityIdInstance;
                                        
                                        JToken nameValue = entityIdValue["name"];
                                        if (nameValue != null && nameValue.Type != JTokenType.Null)
                                        {
                                            DdlName nameInstance = new DdlName();
                                            entityIdInstance.Name = nameInstance;
                                            
                                            JToken firstPartValue = nameValue["firstPart"];
                                            if (firstPartValue != null && firstPartValue.Type != JTokenType.Null)
                                            {
                                                string firstPartInstance = ((string)firstPartValue);
                                                nameInstance.FirstPart = firstPartInstance;
                                            }
                                            
                                            JToken secondPartValue = nameValue["secondPart"];
                                            if (secondPartValue != null && secondPartValue.Type != JTokenType.Null)
                                            {
                                                string secondPartInstance = ((string)secondPartValue);
                                                nameInstance.SecondPart = secondPartInstance;
                                            }
                                            
                                            JToken thirdPartValue = nameValue["thirdPart"];
                                            if (thirdPartValue != null && thirdPartValue.Type != JTokenType.Null)
                                            {
                                                string thirdPartInstance = ((string)thirdPartValue);
                                                nameInstance.ThirdPart = thirdPartInstance;
                                            }
                                            
                                            JToken serverValue = nameValue["server"];
                                            if (serverValue != null && serverValue.Type != JTokenType.Null)
                                            {
                                                string serverInstance = ((string)serverValue);
                                                nameInstance.Server = serverInstance;
                                            }
                                        }
                                        
                                        JToken versionValue = entityIdValue["version"];
                                        if (versionValue != null && versionValue.Type != JTokenType.Null)
                                        {
                                            Guid versionInstance = Guid.Parse(((string)versionValue));
                                            entityIdInstance.Version = versionInstance;
                                        }
                                    }
                                }
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                assemblyInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue2 = responseDoc["version"];
                            if (versionValue2 != null && versionValue2.Type != JTokenType.Null)
                            {
                                Guid versionInstance2 = Guid.Parse(((string)versionValue2));
                                assemblyInstance.Version = versionInstance2;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified database from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The path to the file to create.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get Database operation response.
        /// </returns>
        public async Task<CatalogDatabaseGetResponse> GetDatabaseAsync(string resourceGroupName, string accountName, string databaseName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                TracingAdapter.Enter(invocationId, this, "GetDatabaseAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogDatabaseGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogDatabaseGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlDatabase databaseInstance = new USqlDatabase();
                            result.Database = databaseInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                databaseInstance.Name = databaseNameInstance;
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                databaseInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                databaseInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified external data source from the current
        /// DataLakeAnalytics catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the external Data Source
        /// in.
        /// </param>
        /// <param name='externalDataSourceName'>
        /// Required. The name of the external Data Source to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get external data source operation response.
        /// </returns>
        public async Task<CatalogExternalDataSourceGetResponse> GetExternalDataSourceAsync(string resourceGroupName, string accountName, string databaseName, string externalDataSourceName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (externalDataSourceName == null)
            {
                throw new ArgumentNullException("externalDataSourceName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("externalDataSourceName", externalDataSourceName);
                TracingAdapter.Enter(invocationId, this, "GetExternalDataSourceAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/externaldatasources/";
            url = url + Uri.EscapeDataString(externalDataSourceName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogExternalDataSourceGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogExternalDataSourceGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlExternalDataSource externalDataSourceInstance = new USqlExternalDataSource();
                            result.ExternalDataSource = externalDataSourceInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                externalDataSourceInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken externalDataSourceNameValue = responseDoc["externalDataSourceName"];
                            if (externalDataSourceNameValue != null && externalDataSourceNameValue.Type != JTokenType.Null)
                            {
                                string externalDataSourceNameInstance = ((string)externalDataSourceNameValue);
                                externalDataSourceInstance.Name = externalDataSourceNameInstance;
                            }
                            
                            JToken providerValue = responseDoc["provider"];
                            if (providerValue != null && providerValue.Type != JTokenType.Null)
                            {
                                string providerInstance = ((string)providerValue);
                                externalDataSourceInstance.Provider = providerInstance;
                            }
                            
                            JToken providerStringValue = responseDoc["providerString"];
                            if (providerStringValue != null && providerStringValue.Type != JTokenType.Null)
                            {
                                string providerStringInstance = ((string)providerStringValue);
                                externalDataSourceInstance.ProviderString = providerStringInstance;
                            }
                            
                            JToken pushdownTypesArray = responseDoc["pushdownTypes"];
                            if (pushdownTypesArray != null && pushdownTypesArray.Type != JTokenType.Null)
                            {
                                foreach (JToken pushdownTypesValue in ((JArray)pushdownTypesArray))
                                {
                                    externalDataSourceInstance.PushdownTypes.Add(((string)pushdownTypesValue));
                                }
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                externalDataSourceInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                externalDataSourceInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified schema from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the schema in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get schema operation response.
        /// </returns>
        public async Task<CatalogSchemaGetResponse> GetSchemaAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                TracingAdapter.Enter(invocationId, this, "GetSchemaAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogSchemaGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogSchemaGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlSchema schemaInstance = new USqlSchema();
                            result.Schema = schemaInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                schemaInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken schemaNameValue = responseDoc["schemaName"];
                            if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                            {
                                string schemaNameInstance = ((string)schemaNameValue);
                                schemaInstance.Name = schemaNameInstance;
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                schemaInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                schemaInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified table from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the table in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the table in.
        /// </param>
        /// <param name='tableName'>
        /// Required. The name of the table to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get table operation response.
        /// </returns>
        public async Task<CatalogTableGetResponse> GetTableAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, string tableName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            if (tableName == null)
            {
                throw new ArgumentNullException("tableName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                tracingParameters.Add("tableName", tableName);
                TracingAdapter.Enter(invocationId, this, "GetTableAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tables/";
            url = url + Uri.EscapeDataString(tableName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTable tableInstance = new USqlTable();
                            result.Table = tableInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                tableInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken schemaNameValue = responseDoc["schemaName"];
                            if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                            {
                                string schemaNameInstance = ((string)schemaNameValue);
                                tableInstance.SchemaName = schemaNameInstance;
                            }
                            
                            JToken tableNameValue = responseDoc["tableName"];
                            if (tableNameValue != null && tableNameValue.Type != JTokenType.Null)
                            {
                                string tableNameInstance = ((string)tableNameValue);
                                tableInstance.Name = tableNameInstance;
                            }
                            
                            JToken columnListArray = responseDoc["columnList"];
                            if (columnListArray != null && columnListArray.Type != JTokenType.Null)
                            {
                                foreach (JToken columnListValue in ((JArray)columnListArray))
                                {
                                    USqlTableColumn uSqlTableColumnInstance = new USqlTableColumn();
                                    tableInstance.ColumnList.Add(uSqlTableColumnInstance);
                                    
                                    JToken nameValue = columnListValue["name"];
                                    if (nameValue != null && nameValue.Type != JTokenType.Null)
                                    {
                                        string nameInstance = ((string)nameValue);
                                        uSqlTableColumnInstance.Name = nameInstance;
                                    }
                                    
                                    JToken typeValue = columnListValue["type"];
                                    if (typeValue != null && typeValue.Type != JTokenType.Null)
                                    {
                                        string typeInstance = ((string)typeValue);
                                        uSqlTableColumnInstance.Type = typeInstance;
                                    }
                                }
                            }
                            
                            JToken indexListArray = responseDoc["indexList"];
                            if (indexListArray != null && indexListArray.Type != JTokenType.Null)
                            {
                                foreach (JToken indexListValue in ((JArray)indexListArray))
                                {
                                    USqlIndex uSqlIndexInstance = new USqlIndex();
                                    tableInstance.IndexList.Add(uSqlIndexInstance);
                                    
                                    JToken nameValue2 = indexListValue["name"];
                                    if (nameValue2 != null && nameValue2.Type != JTokenType.Null)
                                    {
                                        string nameInstance2 = ((string)nameValue2);
                                        uSqlIndexInstance.Name = nameInstance2;
                                    }
                                    
                                    JToken indexKeysArray = indexListValue["indexKeys"];
                                    if (indexKeysArray != null && indexKeysArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken indexKeysValue in ((JArray)indexKeysArray))
                                        {
                                            USqlDirectedColumn uSqlDirectedColumnInstance = new USqlDirectedColumn();
                                            uSqlIndexInstance.IndexKeys.Add(uSqlDirectedColumnInstance);
                                            
                                            JToken nameValue3 = indexKeysValue["name"];
                                            if (nameValue3 != null && nameValue3.Type != JTokenType.Null)
                                            {
                                                string nameInstance3 = ((string)nameValue3);
                                                uSqlDirectedColumnInstance.Name = nameInstance3;
                                            }
                                            
                                            JToken descendingValue = indexKeysValue["descending"];
                                            if (descendingValue != null && descendingValue.Type != JTokenType.Null)
                                            {
                                                bool descendingInstance = ((bool)descendingValue);
                                                uSqlDirectedColumnInstance.Descending = descendingInstance;
                                            }
                                        }
                                    }
                                    
                                    JToken columnsArray = indexListValue["columns"];
                                    if (columnsArray != null && columnsArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken columnsValue in ((JArray)columnsArray))
                                        {
                                            uSqlIndexInstance.Columns.Add(((string)columnsValue));
                                        }
                                    }
                                    
                                    JToken distributionInfoValue = indexListValue["distributionInfo"];
                                    if (distributionInfoValue != null && distributionInfoValue.Type != JTokenType.Null)
                                    {
                                        USqlDistributionInfo distributionInfoInstance = new USqlDistributionInfo();
                                        uSqlIndexInstance.DistributionInfo = distributionInfoInstance;
                                        
                                        JToken typeValue2 = distributionInfoValue["type"];
                                        if (typeValue2 != null && typeValue2.Type != JTokenType.Null)
                                        {
                                            int typeInstance2 = ((int)typeValue2);
                                            distributionInfoInstance.Type = typeInstance2;
                                        }
                                        
                                        JToken keysArray = distributionInfoValue["keys"];
                                        if (keysArray != null && keysArray.Type != JTokenType.Null)
                                        {
                                            foreach (JToken keysValue in ((JArray)keysArray))
                                            {
                                                USqlDirectedColumn uSqlDirectedColumnInstance2 = new USqlDirectedColumn();
                                                distributionInfoInstance.Keys.Add(uSqlDirectedColumnInstance2);
                                                
                                                JToken nameValue4 = keysValue["name"];
                                                if (nameValue4 != null && nameValue4.Type != JTokenType.Null)
                                                {
                                                    string nameInstance4 = ((string)nameValue4);
                                                    uSqlDirectedColumnInstance2.Name = nameInstance4;
                                                }
                                                
                                                JToken descendingValue2 = keysValue["descending"];
                                                if (descendingValue2 != null && descendingValue2.Type != JTokenType.Null)
                                                {
                                                    bool descendingInstance2 = ((bool)descendingValue2);
                                                    uSqlDirectedColumnInstance2.Descending = descendingInstance2;
                                                }
                                            }
                                        }
                                        
                                        JToken countValue = distributionInfoValue["count"];
                                        if (countValue != null && countValue.Type != JTokenType.Null)
                                        {
                                            int countInstance = ((int)countValue);
                                            distributionInfoInstance.Count = countInstance;
                                        }
                                    }
                                    
                                    JToken partitionFunctionValue = indexListValue["partitionFunction"];
                                    if (partitionFunctionValue != null && partitionFunctionValue.Type != JTokenType.Null)
                                    {
                                        Guid partitionFunctionInstance = Guid.Parse(((string)partitionFunctionValue));
                                        uSqlIndexInstance.PartitionFunction = partitionFunctionInstance;
                                    }
                                    
                                    JToken partitionKeyListArray = indexListValue["partitionKeyList"];
                                    if (partitionKeyListArray != null && partitionKeyListArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken partitionKeyListValue in ((JArray)partitionKeyListArray))
                                        {
                                            uSqlIndexInstance.PartitionKeyList.Add(((string)partitionKeyListValue));
                                        }
                                    }
                                    
                                    JToken streamNamesArray = indexListValue["streamNames"];
                                    if (streamNamesArray != null && streamNamesArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken streamNamesValue in ((JArray)streamNamesArray))
                                        {
                                            uSqlIndexInstance.StreamNames.Add(((string)streamNamesValue));
                                        }
                                    }
                                    
                                    JToken isColumnstoreValue = indexListValue["isColumnstore"];
                                    if (isColumnstoreValue != null && isColumnstoreValue.Type != JTokenType.Null)
                                    {
                                        bool isColumnstoreInstance = ((bool)isColumnstoreValue);
                                        uSqlIndexInstance.IsColumnstore = isColumnstoreInstance;
                                    }
                                    
                                    JToken indexIdValue = indexListValue["indexId"];
                                    if (indexIdValue != null && indexIdValue.Type != JTokenType.Null)
                                    {
                                        int indexIdInstance = ((int)indexIdValue);
                                        uSqlIndexInstance.IndexId = indexIdInstance;
                                    }
                                    
                                    JToken isUniqueValue = indexListValue["isUnique"];
                                    if (isUniqueValue != null && isUniqueValue.Type != JTokenType.Null)
                                    {
                                        bool isUniqueInstance = ((bool)isUniqueValue);
                                        uSqlIndexInstance.IsCoIsUniquelumnstore = isUniqueInstance;
                                    }
                                }
                            }
                            
                            JToken partitionKeyListArray2 = responseDoc["partitionKeyList"];
                            if (partitionKeyListArray2 != null && partitionKeyListArray2.Type != JTokenType.Null)
                            {
                                foreach (JToken partitionKeyListValue2 in ((JArray)partitionKeyListArray2))
                                {
                                    tableInstance.PartitionKeyList.Add(((string)partitionKeyListValue2));
                                }
                            }
                            
                            JToken externalTableValue = responseDoc["externalTable"];
                            if (externalTableValue != null && externalTableValue.Type != JTokenType.Null)
                            {
                                ExternalTable externalTableInstance = new ExternalTable();
                                tableInstance.ExternalTable = externalTableInstance;
                                
                                JToken tableNameValue2 = externalTableValue["tableName"];
                                if (tableNameValue2 != null && tableNameValue2.Type != JTokenType.Null)
                                {
                                    string tableNameInstance2 = ((string)tableNameValue2);
                                    externalTableInstance.TableName = tableNameInstance2;
                                }
                                
                                JToken dataSourceValue = externalTableValue["dataSource"];
                                if (dataSourceValue != null && dataSourceValue.Type != JTokenType.Null)
                                {
                                    EntityId dataSourceInstance = new EntityId();
                                    externalTableInstance.DataSource = dataSourceInstance;
                                    
                                    JToken nameValue5 = dataSourceValue["name"];
                                    if (nameValue5 != null && nameValue5.Type != JTokenType.Null)
                                    {
                                        DdlName nameInstance5 = new DdlName();
                                        dataSourceInstance.Name = nameInstance5;
                                        
                                        JToken firstPartValue = nameValue5["firstPart"];
                                        if (firstPartValue != null && firstPartValue.Type != JTokenType.Null)
                                        {
                                            string firstPartInstance = ((string)firstPartValue);
                                            nameInstance5.FirstPart = firstPartInstance;
                                        }
                                        
                                        JToken secondPartValue = nameValue5["secondPart"];
                                        if (secondPartValue != null && secondPartValue.Type != JTokenType.Null)
                                        {
                                            string secondPartInstance = ((string)secondPartValue);
                                            nameInstance5.SecondPart = secondPartInstance;
                                        }
                                        
                                        JToken thirdPartValue = nameValue5["thirdPart"];
                                        if (thirdPartValue != null && thirdPartValue.Type != JTokenType.Null)
                                        {
                                            string thirdPartInstance = ((string)thirdPartValue);
                                            nameInstance5.ThirdPart = thirdPartInstance;
                                        }
                                        
                                        JToken serverValue = nameValue5["server"];
                                        if (serverValue != null && serverValue.Type != JTokenType.Null)
                                        {
                                            string serverInstance = ((string)serverValue);
                                            nameInstance5.Server = serverInstance;
                                        }
                                    }
                                    
                                    JToken versionValue = dataSourceValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        dataSourceInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                tableInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue2 = responseDoc["version"];
                            if (versionValue2 != null && versionValue2.Type != JTokenType.Null)
                            {
                                Guid versionInstance2 = Guid.Parse(((string)versionValue2));
                                tableInstance.Version = versionInstance2;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified table from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the statistics in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the statistics in.
        /// </param>
        /// <param name='tableName'>
        /// Required. The name of the table to find the statistics in.
        /// </param>
        /// <param name='statisticsName'>
        /// Required. The name of the table statistics to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get table statistics operation response.
        /// </returns>
        public async Task<CatalogTableStatisticsGetResponse> GetTableStatisticAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, string tableName, string statisticsName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            if (tableName == null)
            {
                throw new ArgumentNullException("tableName");
            }
            if (statisticsName == null)
            {
                throw new ArgumentNullException("statisticsName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                tracingParameters.Add("tableName", tableName);
                tracingParameters.Add("statisticsName", statisticsName);
                TracingAdapter.Enter(invocationId, this, "GetTableStatisticAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tables/";
            url = url + Uri.EscapeDataString(tableName);
            url = url + "/statistics/";
            url = url + Uri.EscapeDataString(statisticsName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableStatisticsGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableStatisticsGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTableStatistics statisticsInstance = new USqlTableStatistics();
                            result.Statistics = statisticsInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                statisticsInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken schemaNameValue = responseDoc["schemaName"];
                            if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                            {
                                string schemaNameInstance = ((string)schemaNameValue);
                                statisticsInstance.SchemaName = schemaNameInstance;
                            }
                            
                            JToken tableNameValue = responseDoc["tableName"];
                            if (tableNameValue != null && tableNameValue.Type != JTokenType.Null)
                            {
                                string tableNameInstance = ((string)tableNameValue);
                                statisticsInstance.TableName = tableNameInstance;
                            }
                            
                            JToken statisticsNameValue = responseDoc["statisticsName"];
                            if (statisticsNameValue != null && statisticsNameValue.Type != JTokenType.Null)
                            {
                                string statisticsNameInstance = ((string)statisticsNameValue);
                                statisticsInstance.Name = statisticsNameInstance;
                            }
                            
                            JToken userStatNameValue = responseDoc["userStatName"];
                            if (userStatNameValue != null && userStatNameValue.Type != JTokenType.Null)
                            {
                                string userStatNameInstance = ((string)userStatNameValue);
                                statisticsInstance.UserStatName = userStatNameInstance;
                            }
                            
                            JToken statDataPathValue = responseDoc["statDataPath"];
                            if (statDataPathValue != null && statDataPathValue.Type != JTokenType.Null)
                            {
                                string statDataPathInstance = ((string)statDataPathValue);
                                statisticsInstance.StatDataPath = statDataPathInstance;
                            }
                            
                            JToken createTimeValue = responseDoc["createTime"];
                            if (createTimeValue != null && createTimeValue.Type != JTokenType.Null)
                            {
                                DateTimeOffset createTimeInstance = ((DateTimeOffset)createTimeValue);
                                statisticsInstance.CreateTime = createTimeInstance;
                            }
                            
                            JToken updateTimeValue = responseDoc["updateTime"];
                            if (updateTimeValue != null && updateTimeValue.Type != JTokenType.Null)
                            {
                                DateTimeOffset updateTimeInstance = ((DateTimeOffset)updateTimeValue);
                                statisticsInstance.UpdateTime = updateTimeInstance;
                            }
                            
                            JToken isUserCreatedValue = responseDoc["isUserCreated"];
                            if (isUserCreatedValue != null && isUserCreatedValue.Type != JTokenType.Null)
                            {
                                bool isUserCreatedInstance = ((bool)isUserCreatedValue);
                                statisticsInstance.IsUserCreated = isUserCreatedInstance;
                            }
                            
                            JToken isAutoCreatedValue = responseDoc["isAutoCreated"];
                            if (isAutoCreatedValue != null && isAutoCreatedValue.Type != JTokenType.Null)
                            {
                                bool isAutoCreatedInstance = ((bool)isAutoCreatedValue);
                                statisticsInstance.IsAutoCreated = isAutoCreatedInstance;
                            }
                            
                            JToken hasFilterValue = responseDoc["hasFilter"];
                            if (hasFilterValue != null && hasFilterValue.Type != JTokenType.Null)
                            {
                                bool hasFilterInstance = ((bool)hasFilterValue);
                                statisticsInstance.HasFilter = hasFilterInstance;
                            }
                            
                            JToken filterDefinitionValue = responseDoc["filterDefinition"];
                            if (filterDefinitionValue != null && filterDefinitionValue.Type != JTokenType.Null)
                            {
                                string filterDefinitionInstance = ((string)filterDefinitionValue);
                                statisticsInstance.FilterDefinition = filterDefinitionInstance;
                            }
                            
                            JToken colNamesArray = responseDoc["colNames"];
                            if (colNamesArray != null && colNamesArray.Type != JTokenType.Null)
                            {
                                foreach (JToken colNamesValue in ((JArray)colNamesArray))
                                {
                                    statisticsInstance.ColNames.Add(((string)colNamesValue));
                                }
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                statisticsInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                statisticsInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the specified table valued function from the current
        /// DataLakeAnalytics catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the table valued
        /// function in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the table valued function
        /// in.
        /// </param>
        /// <param name='tableValuedFunctionName'>
        /// Required. The name of the tableValuedFunction to find.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The Get table valued function operation response.
        /// </returns>
        public async Task<CatalogTableValuedFunctionGetResponse> GetTableValuedFunctionAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, string tableValuedFunctionName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            if (tableValuedFunctionName == null)
            {
                throw new ArgumentNullException("tableValuedFunctionName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                tracingParameters.Add("tableValuedFunctionName", tableValuedFunctionName);
                TracingAdapter.Enter(invocationId, this, "GetTableValuedFunctionAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tablevaluedfunctions/";
            url = url + Uri.EscapeDataString(tableValuedFunctionName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableValuedFunctionGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableValuedFunctionGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTableValuedFunction tableValuedFunctionInstance = new USqlTableValuedFunction();
                            result.TableValuedFunction = tableValuedFunctionInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                tableValuedFunctionInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken schemaNameValue = responseDoc["schemaName"];
                            if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                            {
                                string schemaNameInstance = ((string)schemaNameValue);
                                tableValuedFunctionInstance.SchemaName = schemaNameInstance;
                            }
                            
                            JToken tvfNameValue = responseDoc["tvfName"];
                            if (tvfNameValue != null && tvfNameValue.Type != JTokenType.Null)
                            {
                                string tvfNameInstance = ((string)tvfNameValue);
                                tableValuedFunctionInstance.Name = tvfNameInstance;
                            }
                            
                            JToken definitionValue = responseDoc["definition"];
                            if (definitionValue != null && definitionValue.Type != JTokenType.Null)
                            {
                                string definitionInstance = ((string)definitionValue);
                                tableValuedFunctionInstance.Definition = definitionInstance;
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                tableValuedFunctionInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                tableValuedFunctionInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of assemblies from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the assembly in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List Database operation response.
        /// </returns>
        public async Task<CatalogAssemblyListGetResponse> ListAssembliesAsync(string resourceGroupName, string accountName, string databaseName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                TracingAdapter.Enter(invocationId, this, "ListAssembliesAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/assemblies";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogAssemblyListGetResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogAssemblyListGetResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlAssemblyList assemblyListInstance = new USqlAssemblyList();
                            result.AssemblyList = assemblyListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlAssemblyClr uSqlAssemblyClrInstance = new USqlAssemblyClr();
                                    assemblyListInstance.Value.Add(uSqlAssemblyClrInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlAssemblyClrInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken assemblyClrNameValue = valueValue["assemblyClrName"];
                                    if (assemblyClrNameValue != null && assemblyClrNameValue.Type != JTokenType.Null)
                                    {
                                        string assemblyClrNameInstance = ((string)assemblyClrNameValue);
                                        uSqlAssemblyClrInstance.Name = assemblyClrNameInstance;
                                    }
                                    
                                    JToken clrNameValue = valueValue["clrName"];
                                    if (clrNameValue != null && clrNameValue.Type != JTokenType.Null)
                                    {
                                        string clrNameInstance = ((string)clrNameValue);
                                        uSqlAssemblyClrInstance.ClrName = clrNameInstance;
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlAssemblyClrInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlAssemblyClrInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                assemblyListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                assemblyListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                assemblyListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of databases from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List Database operation response.
        /// </returns>
        public async Task<CatalogDatabaseListResponse> ListDatabasesAsync(string resourceGroupName, string accountName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                TracingAdapter.Enter(invocationId, this, "ListDatabasesAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogDatabaseListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogDatabaseListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlDatabaseList databaseListInstance = new USqlDatabaseList();
                            result.DatabaseList = databaseListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlDatabase uSqlDatabaseInstance = new USqlDatabase();
                                    databaseListInstance.Value.Add(uSqlDatabaseInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlDatabaseInstance.Name = databaseNameInstance;
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlDatabaseInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlDatabaseInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                databaseListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                databaseListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                databaseListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of external data sources from the current
        /// DataLakeAnalytics catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the external Data Source
        /// in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List external data source operation response.
        /// </returns>
        public async Task<CatalogExternalDataSourceListResponse> ListExternalDataSourcesAsync(string resourceGroupName, string accountName, string databaseName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                TracingAdapter.Enter(invocationId, this, "ListExternalDataSourcesAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/externaldatasources";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogExternalDataSourceListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogExternalDataSourceListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlExternalDataSourceList externalDataSourceListInstance = new USqlExternalDataSourceList();
                            result.ExternalDataSourceList = externalDataSourceListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlExternalDataSource uSqlExternalDataSourceInstance = new USqlExternalDataSource();
                                    externalDataSourceListInstance.Value.Add(uSqlExternalDataSourceInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlExternalDataSourceInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken externalDataSourceNameValue = valueValue["externalDataSourceName"];
                                    if (externalDataSourceNameValue != null && externalDataSourceNameValue.Type != JTokenType.Null)
                                    {
                                        string externalDataSourceNameInstance = ((string)externalDataSourceNameValue);
                                        uSqlExternalDataSourceInstance.Name = externalDataSourceNameInstance;
                                    }
                                    
                                    JToken providerValue = valueValue["provider"];
                                    if (providerValue != null && providerValue.Type != JTokenType.Null)
                                    {
                                        string providerInstance = ((string)providerValue);
                                        uSqlExternalDataSourceInstance.Provider = providerInstance;
                                    }
                                    
                                    JToken providerStringValue = valueValue["providerString"];
                                    if (providerStringValue != null && providerStringValue.Type != JTokenType.Null)
                                    {
                                        string providerStringInstance = ((string)providerStringValue);
                                        uSqlExternalDataSourceInstance.ProviderString = providerStringInstance;
                                    }
                                    
                                    JToken pushdownTypesArray = valueValue["pushdownTypes"];
                                    if (pushdownTypesArray != null && pushdownTypesArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken pushdownTypesValue in ((JArray)pushdownTypesArray))
                                        {
                                            uSqlExternalDataSourceInstance.PushdownTypes.Add(((string)pushdownTypesValue));
                                        }
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlExternalDataSourceInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlExternalDataSourceInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                externalDataSourceListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                externalDataSourceListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                externalDataSourceListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of schemas from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the schema in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List schema operation response.
        /// </returns>
        public async Task<CatalogSchemaListResponse> ListSchemasAsync(string resourceGroupName, string accountName, string databaseName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                TracingAdapter.Enter(invocationId, this, "ListSchemasAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogSchemaListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogSchemaListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlSchemaList schemaListInstance = new USqlSchemaList();
                            result.SchemaList = schemaListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlSchema uSqlSchemaInstance = new USqlSchema();
                                    schemaListInstance.Value.Add(uSqlSchemaInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlSchemaInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken schemaNameValue = valueValue["schemaName"];
                                    if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                                    {
                                        string schemaNameInstance = ((string)schemaNameValue);
                                        uSqlSchemaInstance.Name = schemaNameInstance;
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlSchemaInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlSchemaInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                schemaListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                schemaListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                schemaListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of tables from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the tables in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the tables in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List tables operation response.
        /// </returns>
        public async Task<CatalogTableListResponse> ListTablesAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                TracingAdapter.Enter(invocationId, this, "ListTablesAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tables";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTableList tableListInstance = new USqlTableList();
                            result.TableList = tableListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlTable uSqlTableInstance = new USqlTable();
                                    tableListInstance.Value.Add(uSqlTableInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlTableInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken schemaNameValue = valueValue["schemaName"];
                                    if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                                    {
                                        string schemaNameInstance = ((string)schemaNameValue);
                                        uSqlTableInstance.SchemaName = schemaNameInstance;
                                    }
                                    
                                    JToken tableNameValue = valueValue["tableName"];
                                    if (tableNameValue != null && tableNameValue.Type != JTokenType.Null)
                                    {
                                        string tableNameInstance = ((string)tableNameValue);
                                        uSqlTableInstance.Name = tableNameInstance;
                                    }
                                    
                                    JToken columnListArray = valueValue["columnList"];
                                    if (columnListArray != null && columnListArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken columnListValue in ((JArray)columnListArray))
                                        {
                                            USqlTableColumn uSqlTableColumnInstance = new USqlTableColumn();
                                            uSqlTableInstance.ColumnList.Add(uSqlTableColumnInstance);
                                            
                                            JToken nameValue = columnListValue["name"];
                                            if (nameValue != null && nameValue.Type != JTokenType.Null)
                                            {
                                                string nameInstance = ((string)nameValue);
                                                uSqlTableColumnInstance.Name = nameInstance;
                                            }
                                            
                                            JToken typeValue = columnListValue["type"];
                                            if (typeValue != null && typeValue.Type != JTokenType.Null)
                                            {
                                                string typeInstance = ((string)typeValue);
                                                uSqlTableColumnInstance.Type = typeInstance;
                                            }
                                        }
                                    }
                                    
                                    JToken indexListArray = valueValue["indexList"];
                                    if (indexListArray != null && indexListArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken indexListValue in ((JArray)indexListArray))
                                        {
                                            USqlIndex uSqlIndexInstance = new USqlIndex();
                                            uSqlTableInstance.IndexList.Add(uSqlIndexInstance);
                                            
                                            JToken nameValue2 = indexListValue["name"];
                                            if (nameValue2 != null && nameValue2.Type != JTokenType.Null)
                                            {
                                                string nameInstance2 = ((string)nameValue2);
                                                uSqlIndexInstance.Name = nameInstance2;
                                            }
                                            
                                            JToken indexKeysArray = indexListValue["indexKeys"];
                                            if (indexKeysArray != null && indexKeysArray.Type != JTokenType.Null)
                                            {
                                                foreach (JToken indexKeysValue in ((JArray)indexKeysArray))
                                                {
                                                    USqlDirectedColumn uSqlDirectedColumnInstance = new USqlDirectedColumn();
                                                    uSqlIndexInstance.IndexKeys.Add(uSqlDirectedColumnInstance);
                                                    
                                                    JToken nameValue3 = indexKeysValue["name"];
                                                    if (nameValue3 != null && nameValue3.Type != JTokenType.Null)
                                                    {
                                                        string nameInstance3 = ((string)nameValue3);
                                                        uSqlDirectedColumnInstance.Name = nameInstance3;
                                                    }
                                                    
                                                    JToken descendingValue = indexKeysValue["descending"];
                                                    if (descendingValue != null && descendingValue.Type != JTokenType.Null)
                                                    {
                                                        bool descendingInstance = ((bool)descendingValue);
                                                        uSqlDirectedColumnInstance.Descending = descendingInstance;
                                                    }
                                                }
                                            }
                                            
                                            JToken columnsArray = indexListValue["columns"];
                                            if (columnsArray != null && columnsArray.Type != JTokenType.Null)
                                            {
                                                foreach (JToken columnsValue in ((JArray)columnsArray))
                                                {
                                                    uSqlIndexInstance.Columns.Add(((string)columnsValue));
                                                }
                                            }
                                            
                                            JToken distributionInfoValue = indexListValue["distributionInfo"];
                                            if (distributionInfoValue != null && distributionInfoValue.Type != JTokenType.Null)
                                            {
                                                USqlDistributionInfo distributionInfoInstance = new USqlDistributionInfo();
                                                uSqlIndexInstance.DistributionInfo = distributionInfoInstance;
                                                
                                                JToken typeValue2 = distributionInfoValue["type"];
                                                if (typeValue2 != null && typeValue2.Type != JTokenType.Null)
                                                {
                                                    int typeInstance2 = ((int)typeValue2);
                                                    distributionInfoInstance.Type = typeInstance2;
                                                }
                                                
                                                JToken keysArray = distributionInfoValue["keys"];
                                                if (keysArray != null && keysArray.Type != JTokenType.Null)
                                                {
                                                    foreach (JToken keysValue in ((JArray)keysArray))
                                                    {
                                                        USqlDirectedColumn uSqlDirectedColumnInstance2 = new USqlDirectedColumn();
                                                        distributionInfoInstance.Keys.Add(uSqlDirectedColumnInstance2);
                                                        
                                                        JToken nameValue4 = keysValue["name"];
                                                        if (nameValue4 != null && nameValue4.Type != JTokenType.Null)
                                                        {
                                                            string nameInstance4 = ((string)nameValue4);
                                                            uSqlDirectedColumnInstance2.Name = nameInstance4;
                                                        }
                                                        
                                                        JToken descendingValue2 = keysValue["descending"];
                                                        if (descendingValue2 != null && descendingValue2.Type != JTokenType.Null)
                                                        {
                                                            bool descendingInstance2 = ((bool)descendingValue2);
                                                            uSqlDirectedColumnInstance2.Descending = descendingInstance2;
                                                        }
                                                    }
                                                }
                                                
                                                JToken countValue = distributionInfoValue["count"];
                                                if (countValue != null && countValue.Type != JTokenType.Null)
                                                {
                                                    int countInstance = ((int)countValue);
                                                    distributionInfoInstance.Count = countInstance;
                                                }
                                            }
                                            
                                            JToken partitionFunctionValue = indexListValue["partitionFunction"];
                                            if (partitionFunctionValue != null && partitionFunctionValue.Type != JTokenType.Null)
                                            {
                                                Guid partitionFunctionInstance = Guid.Parse(((string)partitionFunctionValue));
                                                uSqlIndexInstance.PartitionFunction = partitionFunctionInstance;
                                            }
                                            
                                            JToken partitionKeyListArray = indexListValue["partitionKeyList"];
                                            if (partitionKeyListArray != null && partitionKeyListArray.Type != JTokenType.Null)
                                            {
                                                foreach (JToken partitionKeyListValue in ((JArray)partitionKeyListArray))
                                                {
                                                    uSqlIndexInstance.PartitionKeyList.Add(((string)partitionKeyListValue));
                                                }
                                            }
                                            
                                            JToken streamNamesArray = indexListValue["streamNames"];
                                            if (streamNamesArray != null && streamNamesArray.Type != JTokenType.Null)
                                            {
                                                foreach (JToken streamNamesValue in ((JArray)streamNamesArray))
                                                {
                                                    uSqlIndexInstance.StreamNames.Add(((string)streamNamesValue));
                                                }
                                            }
                                            
                                            JToken isColumnstoreValue = indexListValue["isColumnstore"];
                                            if (isColumnstoreValue != null && isColumnstoreValue.Type != JTokenType.Null)
                                            {
                                                bool isColumnstoreInstance = ((bool)isColumnstoreValue);
                                                uSqlIndexInstance.IsColumnstore = isColumnstoreInstance;
                                            }
                                            
                                            JToken indexIdValue = indexListValue["indexId"];
                                            if (indexIdValue != null && indexIdValue.Type != JTokenType.Null)
                                            {
                                                int indexIdInstance = ((int)indexIdValue);
                                                uSqlIndexInstance.IndexId = indexIdInstance;
                                            }
                                            
                                            JToken isUniqueValue = indexListValue["isUnique"];
                                            if (isUniqueValue != null && isUniqueValue.Type != JTokenType.Null)
                                            {
                                                bool isUniqueInstance = ((bool)isUniqueValue);
                                                uSqlIndexInstance.IsCoIsUniquelumnstore = isUniqueInstance;
                                            }
                                        }
                                    }
                                    
                                    JToken partitionKeyListArray2 = valueValue["partitionKeyList"];
                                    if (partitionKeyListArray2 != null && partitionKeyListArray2.Type != JTokenType.Null)
                                    {
                                        foreach (JToken partitionKeyListValue2 in ((JArray)partitionKeyListArray2))
                                        {
                                            uSqlTableInstance.PartitionKeyList.Add(((string)partitionKeyListValue2));
                                        }
                                    }
                                    
                                    JToken externalTableValue = valueValue["externalTable"];
                                    if (externalTableValue != null && externalTableValue.Type != JTokenType.Null)
                                    {
                                        ExternalTable externalTableInstance = new ExternalTable();
                                        uSqlTableInstance.ExternalTable = externalTableInstance;
                                        
                                        JToken tableNameValue2 = externalTableValue["tableName"];
                                        if (tableNameValue2 != null && tableNameValue2.Type != JTokenType.Null)
                                        {
                                            string tableNameInstance2 = ((string)tableNameValue2);
                                            externalTableInstance.TableName = tableNameInstance2;
                                        }
                                        
                                        JToken dataSourceValue = externalTableValue["dataSource"];
                                        if (dataSourceValue != null && dataSourceValue.Type != JTokenType.Null)
                                        {
                                            EntityId dataSourceInstance = new EntityId();
                                            externalTableInstance.DataSource = dataSourceInstance;
                                            
                                            JToken nameValue5 = dataSourceValue["name"];
                                            if (nameValue5 != null && nameValue5.Type != JTokenType.Null)
                                            {
                                                DdlName nameInstance5 = new DdlName();
                                                dataSourceInstance.Name = nameInstance5;
                                                
                                                JToken firstPartValue = nameValue5["firstPart"];
                                                if (firstPartValue != null && firstPartValue.Type != JTokenType.Null)
                                                {
                                                    string firstPartInstance = ((string)firstPartValue);
                                                    nameInstance5.FirstPart = firstPartInstance;
                                                }
                                                
                                                JToken secondPartValue = nameValue5["secondPart"];
                                                if (secondPartValue != null && secondPartValue.Type != JTokenType.Null)
                                                {
                                                    string secondPartInstance = ((string)secondPartValue);
                                                    nameInstance5.SecondPart = secondPartInstance;
                                                }
                                                
                                                JToken thirdPartValue = nameValue5["thirdPart"];
                                                if (thirdPartValue != null && thirdPartValue.Type != JTokenType.Null)
                                                {
                                                    string thirdPartInstance = ((string)thirdPartValue);
                                                    nameInstance5.ThirdPart = thirdPartInstance;
                                                }
                                                
                                                JToken serverValue = nameValue5["server"];
                                                if (serverValue != null && serverValue.Type != JTokenType.Null)
                                                {
                                                    string serverInstance = ((string)serverValue);
                                                    nameInstance5.Server = serverInstance;
                                                }
                                            }
                                            
                                            JToken versionValue = dataSourceValue["version"];
                                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                                            {
                                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                                dataSourceInstance.Version = versionInstance;
                                            }
                                        }
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlTableInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue2 = valueValue["version"];
                                    if (versionValue2 != null && versionValue2.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance2 = Guid.Parse(((string)versionValue2));
                                        uSqlTableInstance.Version = versionInstance2;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                tableListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue2 = responseDoc["count"];
                            if (countValue2 != null && countValue2.Type != JTokenType.Null)
                            {
                                int countInstance2 = ((int)countValue2);
                                tableListInstance.Count = countInstance2;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                tableListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of tables from the current DataLakeAnalytics
        /// catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the statistics in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the statistics in.
        /// </param>
        /// <param name='tableName'>
        /// Required. The name of the table to find the statistics in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List table statistics operation response.
        /// </returns>
        public async Task<CatalogTableStatisticsListResponse> ListTableStatisticsAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, string tableName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            if (tableName == null)
            {
                throw new ArgumentNullException("tableName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                tracingParameters.Add("tableName", tableName);
                TracingAdapter.Enter(invocationId, this, "ListTableStatisticsAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tables/";
            url = url + Uri.EscapeDataString(tableName);
            url = url + "/statistics";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableStatisticsListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableStatisticsListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTableStatisticsList statisticsListInstance = new USqlTableStatisticsList();
                            result.StatisticsList = statisticsListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlTableStatistics uSqlTableStatisticsInstance = new USqlTableStatistics();
                                    statisticsListInstance.Value.Add(uSqlTableStatisticsInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlTableStatisticsInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken schemaNameValue = valueValue["schemaName"];
                                    if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                                    {
                                        string schemaNameInstance = ((string)schemaNameValue);
                                        uSqlTableStatisticsInstance.SchemaName = schemaNameInstance;
                                    }
                                    
                                    JToken tableNameValue = valueValue["tableName"];
                                    if (tableNameValue != null && tableNameValue.Type != JTokenType.Null)
                                    {
                                        string tableNameInstance = ((string)tableNameValue);
                                        uSqlTableStatisticsInstance.TableName = tableNameInstance;
                                    }
                                    
                                    JToken statisticsNameValue = valueValue["statisticsName"];
                                    if (statisticsNameValue != null && statisticsNameValue.Type != JTokenType.Null)
                                    {
                                        string statisticsNameInstance = ((string)statisticsNameValue);
                                        uSqlTableStatisticsInstance.Name = statisticsNameInstance;
                                    }
                                    
                                    JToken userStatNameValue = valueValue["userStatName"];
                                    if (userStatNameValue != null && userStatNameValue.Type != JTokenType.Null)
                                    {
                                        string userStatNameInstance = ((string)userStatNameValue);
                                        uSqlTableStatisticsInstance.UserStatName = userStatNameInstance;
                                    }
                                    
                                    JToken statDataPathValue = valueValue["statDataPath"];
                                    if (statDataPathValue != null && statDataPathValue.Type != JTokenType.Null)
                                    {
                                        string statDataPathInstance = ((string)statDataPathValue);
                                        uSqlTableStatisticsInstance.StatDataPath = statDataPathInstance;
                                    }
                                    
                                    JToken createTimeValue = valueValue["createTime"];
                                    if (createTimeValue != null && createTimeValue.Type != JTokenType.Null)
                                    {
                                        DateTimeOffset createTimeInstance = ((DateTimeOffset)createTimeValue);
                                        uSqlTableStatisticsInstance.CreateTime = createTimeInstance;
                                    }
                                    
                                    JToken updateTimeValue = valueValue["updateTime"];
                                    if (updateTimeValue != null && updateTimeValue.Type != JTokenType.Null)
                                    {
                                        DateTimeOffset updateTimeInstance = ((DateTimeOffset)updateTimeValue);
                                        uSqlTableStatisticsInstance.UpdateTime = updateTimeInstance;
                                    }
                                    
                                    JToken isUserCreatedValue = valueValue["isUserCreated"];
                                    if (isUserCreatedValue != null && isUserCreatedValue.Type != JTokenType.Null)
                                    {
                                        bool isUserCreatedInstance = ((bool)isUserCreatedValue);
                                        uSqlTableStatisticsInstance.IsUserCreated = isUserCreatedInstance;
                                    }
                                    
                                    JToken isAutoCreatedValue = valueValue["isAutoCreated"];
                                    if (isAutoCreatedValue != null && isAutoCreatedValue.Type != JTokenType.Null)
                                    {
                                        bool isAutoCreatedInstance = ((bool)isAutoCreatedValue);
                                        uSqlTableStatisticsInstance.IsAutoCreated = isAutoCreatedInstance;
                                    }
                                    
                                    JToken hasFilterValue = valueValue["hasFilter"];
                                    if (hasFilterValue != null && hasFilterValue.Type != JTokenType.Null)
                                    {
                                        bool hasFilterInstance = ((bool)hasFilterValue);
                                        uSqlTableStatisticsInstance.HasFilter = hasFilterInstance;
                                    }
                                    
                                    JToken filterDefinitionValue = valueValue["filterDefinition"];
                                    if (filterDefinitionValue != null && filterDefinitionValue.Type != JTokenType.Null)
                                    {
                                        string filterDefinitionInstance = ((string)filterDefinitionValue);
                                        uSqlTableStatisticsInstance.FilterDefinition = filterDefinitionInstance;
                                    }
                                    
                                    JToken colNamesArray = valueValue["colNames"];
                                    if (colNamesArray != null && colNamesArray.Type != JTokenType.Null)
                                    {
                                        foreach (JToken colNamesValue in ((JArray)colNamesArray))
                                        {
                                            uSqlTableStatisticsInstance.ColNames.Add(((string)colNamesValue));
                                        }
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlTableStatisticsInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlTableStatisticsInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                statisticsListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                statisticsListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                statisticsListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Retrieves the list of table valued functions from the current
        /// DataLakeAnalytics catalog
        /// </summary>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to find the table valued
        /// functions in.
        /// </param>
        /// <param name='schemaName'>
        /// Required. The name of the schema to find the table valued functions
        /// in.
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The List table valued functions operation response.
        /// </returns>
        public async Task<CatalogTableValuedFunctionListResponse> ListTableValuedFunctionsAsync(string resourceGroupName, string accountName, string databaseName, string schemaName, CancellationToken cancellationToken)
        {
            // Validate
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (schemaName == null)
            {
                throw new ArgumentNullException("schemaName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("schemaName", schemaName);
                TracingAdapter.Enter(invocationId, this, "ListTableValuedFunctionsAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/schemas/";
            url = url + Uri.EscapeDataString(schemaName);
            url = url + "/tablevaluedfunctions";
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = HttpMethod.Get;
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, null, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogTableValuedFunctionListResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogTableValuedFunctionListResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlTableValuedFunctionList tableValuedFunctionListInstance = new USqlTableValuedFunctionList();
                            result.TableValuedFunctionList = tableValuedFunctionListInstance;
                            
                            JToken valueArray = responseDoc["value"];
                            if (valueArray != null && valueArray.Type != JTokenType.Null)
                            {
                                foreach (JToken valueValue in ((JArray)valueArray))
                                {
                                    USqlTableValuedFunction uSqlTableValuedFunctionInstance = new USqlTableValuedFunction();
                                    tableValuedFunctionListInstance.Value.Add(uSqlTableValuedFunctionInstance);
                                    
                                    JToken databaseNameValue = valueValue["databaseName"];
                                    if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                                    {
                                        string databaseNameInstance = ((string)databaseNameValue);
                                        uSqlTableValuedFunctionInstance.DatabaseName = databaseNameInstance;
                                    }
                                    
                                    JToken schemaNameValue = valueValue["schemaName"];
                                    if (schemaNameValue != null && schemaNameValue.Type != JTokenType.Null)
                                    {
                                        string schemaNameInstance = ((string)schemaNameValue);
                                        uSqlTableValuedFunctionInstance.SchemaName = schemaNameInstance;
                                    }
                                    
                                    JToken tvfNameValue = valueValue["tvfName"];
                                    if (tvfNameValue != null && tvfNameValue.Type != JTokenType.Null)
                                    {
                                        string tvfNameInstance = ((string)tvfNameValue);
                                        uSqlTableValuedFunctionInstance.Name = tvfNameInstance;
                                    }
                                    
                                    JToken definitionValue = valueValue["definition"];
                                    if (definitionValue != null && definitionValue.Type != JTokenType.Null)
                                    {
                                        string definitionInstance = ((string)definitionValue);
                                        uSqlTableValuedFunctionInstance.Definition = definitionInstance;
                                    }
                                    
                                    JToken computeAccountNameValue = valueValue["computeAccountName"];
                                    if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                                    {
                                        string computeAccountNameInstance = ((string)computeAccountNameValue);
                                        uSqlTableValuedFunctionInstance.ComputeAccountName = computeAccountNameInstance;
                                    }
                                    
                                    JToken versionValue = valueValue["version"];
                                    if (versionValue != null && versionValue.Type != JTokenType.Null)
                                    {
                                        Guid versionInstance = Guid.Parse(((string)versionValue));
                                        uSqlTableValuedFunctionInstance.Version = versionInstance;
                                    }
                                }
                            }
                            
                            JToken itemTypeValue = responseDoc["itemType"];
                            if (itemTypeValue != null && itemTypeValue.Type != JTokenType.Null)
                            {
                                string itemTypeInstance = ((string)itemTypeValue);
                                tableValuedFunctionListInstance.ItemType = itemTypeInstance;
                            }
                            
                            JToken countValue = responseDoc["count"];
                            if (countValue != null && countValue.Type != JTokenType.Null)
                            {
                                int countInstance = ((int)countValue);
                                tableValuedFunctionListInstance.Count = countInstance;
                            }
                            
                            JToken nextLinkValue = responseDoc["nextLink"];
                            if (nextLinkValue != null && nextLinkValue.Type != JTokenType.Null)
                            {
                                string nextLinkInstance = ((string)nextLinkValue);
                                tableValuedFunctionListInstance.NextLink = nextLinkInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
        
        /// <summary>
        /// Modifies the specified secret for use with external data sources in
        /// the specified database
        /// </summary>
        /// <param name='accountName'>
        /// Required. The name of the account to use
        /// </param>
        /// <param name='resourceGroupName'>
        /// Required. The name of the resourceGroup the Data Lake Analytics
        /// account is in
        /// </param>
        /// <param name='databaseName'>
        /// Required. The name of the database to modify the secret in.
        /// </param>
        /// <param name='parameters'>
        /// Required. The parameters required to modify the secret (name and
        /// password)
        /// </param>
        /// <param name='cancellationToken'>
        /// Cancellation token.
        /// </param>
        /// <returns>
        /// The create secret operation response.
        /// </returns>
        public async Task<CatalogSecretCreateResponse> UpdateSecretAsync(string accountName, string resourceGroupName, string databaseName, DataLakeAnalyticsCatalogSecretCreateOrUpdateParameters parameters, CancellationToken cancellationToken)
        {
            // Validate
            if (accountName == null)
            {
                throw new ArgumentNullException("accountName");
            }
            if (resourceGroupName == null)
            {
                throw new ArgumentNullException("resourceGroupName");
            }
            if (databaseName == null)
            {
                throw new ArgumentNullException("databaseName");
            }
            if (parameters == null)
            {
                throw new ArgumentNullException("parameters");
            }
            if (parameters.Password == null)
            {
                throw new ArgumentNullException("parameters.Password");
            }
            if (parameters.SecretName == null)
            {
                throw new ArgumentNullException("parameters.SecretName");
            }
            
            // Tracing
            bool shouldTrace = TracingAdapter.IsEnabled;
            string invocationId = null;
            if (shouldTrace)
            {
                invocationId = TracingAdapter.NextInvocationId.ToString();
                Dictionary<string, object> tracingParameters = new Dictionary<string, object>();
                tracingParameters.Add("accountName", accountName);
                tracingParameters.Add("resourceGroupName", resourceGroupName);
                tracingParameters.Add("databaseName", databaseName);
                tracingParameters.Add("parameters", parameters);
                TracingAdapter.Enter(invocationId, this, "UpdateSecretAsync", tracingParameters);
            }
            
            // Construct URL
            string url = "";
            url = url + "https://";
            url = url + Uri.EscapeDataString(accountName);
            url = url + ".";
            if (this.Client.CatalogServiceUri != null)
            {
                url = url + Uri.EscapeDataString(this.Client.CatalogServiceUri);
            }
            url = url + "/catalog/usql/databases/";
            url = url + Uri.EscapeDataString(databaseName);
            url = url + "/secrets/";
            url = url + Uri.EscapeDataString(parameters.SecretName);
            List<string> queryParameters = new List<string>();
            queryParameters.Add("api-version=2015-10-01-preview");
            if (queryParameters.Count > 0)
            {
                url = url + "?" + string.Join("&", queryParameters);
            }
            url = url.Replace(" ", "%20");
            
            // Create HTTP transport objects
            HttpRequestMessage httpRequest = null;
            try
            {
                httpRequest = new HttpRequestMessage();
                httpRequest.Method = new HttpMethod("PATCH");
                httpRequest.RequestUri = new Uri(url);
                
                // Set Headers
                httpRequest.Headers.Add("useragent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("User-Agent", "Azure SDK - Microsoft.Azure.Management.DataLake.AnalyticsCatalog 0.9.2-preview" + this.Client.UserAgentSuffix);
                httpRequest.Headers.Add("x-ms-client-resource-group-name", resourceGroupName);
                httpRequest.Headers.Add("x-ms-client-subscription-id", this.Client.Credentials.SubscriptionId);
                
                // Set Credentials
                cancellationToken.ThrowIfCancellationRequested();
                await this.Client.Credentials.ProcessHttpRequestAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                
                // Serialize Request
                string requestContent = null;
                JToken requestDoc = null;
                
                JObject dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue = new JObject();
                requestDoc = dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue;
                
                dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue["password"] = parameters.Password;
                
                if (parameters.Uri != null)
                {
                    dataLakeAnalyticsCatalogSecretCreateOrUpdateParametersValue["uri"] = parameters.Uri;
                }
                
                requestContent = requestDoc.ToString(Newtonsoft.Json.Formatting.Indented);
                httpRequest.Content = new StringContent(requestContent, Encoding.UTF8);
                httpRequest.Content.Headers.ContentType = MediaTypeHeaderValue.Parse("application/json");
                
                // Send Request
                HttpResponseMessage httpResponse = null;
                try
                {
                    if (shouldTrace)
                    {
                        TracingAdapter.SendRequest(invocationId, httpRequest);
                    }
                    cancellationToken.ThrowIfCancellationRequested();
                    httpResponse = await this.Client.HttpClient.SendAsync(httpRequest, cancellationToken).ConfigureAwait(false);
                    if (shouldTrace)
                    {
                        TracingAdapter.ReceiveResponse(invocationId, httpResponse);
                    }
                    HttpStatusCode statusCode = httpResponse.StatusCode;
                    if (statusCode != HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        CloudException ex = CloudException.Create(httpRequest, requestContent, httpResponse, await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false));
                        if (shouldTrace)
                        {
                            TracingAdapter.Error(invocationId, ex);
                        }
                        throw ex;
                    }
                    
                    // Create Result
                    CatalogSecretCreateResponse result = null;
                    // Deserialize Response
                    if (statusCode == HttpStatusCode.OK)
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        string responseContent = await httpResponse.Content.ReadAsStringAsync().ConfigureAwait(false);
                        result = new CatalogSecretCreateResponse();
                        JToken responseDoc = null;
                        if (string.IsNullOrEmpty(responseContent) == false)
                        {
                            responseDoc = JToken.Parse(responseContent);
                        }
                        
                        if (responseDoc != null && responseDoc.Type != JTokenType.Null)
                        {
                            USqlSecret secretInstance = new USqlSecret();
                            result.Secret = secretInstance;
                            
                            JToken databaseNameValue = responseDoc["databaseName"];
                            if (databaseNameValue != null && databaseNameValue.Type != JTokenType.Null)
                            {
                                string databaseNameInstance = ((string)databaseNameValue);
                                secretInstance.DatabaseName = databaseNameInstance;
                            }
                            
                            JToken credentialNameValue = responseDoc["credentialName"];
                            if (credentialNameValue != null && credentialNameValue.Type != JTokenType.Null)
                            {
                                string credentialNameInstance = ((string)credentialNameValue);
                                secretInstance.Name = credentialNameInstance;
                            }
                            
                            JToken userNameValue = responseDoc["userName"];
                            if (userNameValue != null && userNameValue.Type != JTokenType.Null)
                            {
                                string userNameInstance = ((string)userNameValue);
                                secretInstance.UserName = userNameInstance;
                            }
                            
                            JToken identityValue = responseDoc["identity"];
                            if (identityValue != null && identityValue.Type != JTokenType.Null)
                            {
                                Guid identityInstance = Guid.Parse(((string)identityValue));
                                secretInstance.Identity = identityInstance;
                            }
                            
                            JToken computeAccountNameValue = responseDoc["computeAccountName"];
                            if (computeAccountNameValue != null && computeAccountNameValue.Type != JTokenType.Null)
                            {
                                string computeAccountNameInstance = ((string)computeAccountNameValue);
                                secretInstance.ComputeAccountName = computeAccountNameInstance;
                            }
                            
                            JToken versionValue = responseDoc["version"];
                            if (versionValue != null && versionValue.Type != JTokenType.Null)
                            {
                                Guid versionInstance = Guid.Parse(((string)versionValue));
                                secretInstance.Version = versionInstance;
                            }
                        }
                        
                    }
                    result.StatusCode = statusCode;
                    if (httpResponse.Headers.Contains("x-ms-request-id"))
                    {
                        result.RequestId = httpResponse.Headers.GetValues("x-ms-request-id").FirstOrDefault();
                    }
                    
                    if (shouldTrace)
                    {
                        TracingAdapter.Exit(invocationId, result);
                    }
                    return result;
                }
                finally
                {
                    if (httpResponse != null)
                    {
                        httpResponse.Dispose();
                    }
                }
            }
            finally
            {
                if (httpRequest != null)
                {
                    httpRequest.Dispose();
                }
            }
        }
    }
}
